"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[6846],{66846:function(e,n,t){t.r(n),t.d(n,{default:function(){return B}});var r=t(33028),o=t(96234),s=t(96902),a=t(13655),c=t(33266),i=t(15996),u=t(44536),l=t(50543),p=t(35388),d=t(25322),f=t(91188),m=t(21051),x=t.n(m),Z=t(95802),h=t(90659),b=t(25471),v=t(32723),g=t(34795),j=t(99836),w=5e5;var C=t(29938),k=(0,s.lazy)((function(){return t.e(289).then(t.bind(t,40289))})),y=(0,s.lazy)((function(){return t.e(8020).then(t.bind(t,78020))})),S=(0,f.ZL)()((function(e){return{button:{margin:e.spacing(1)},formControl:{margin:0},container2:{marginTop:e.spacing(1)}}}));function B(e){var n,t,d=e.model,f=e.feature,m=S().classes,b=f,k=null===(n=b.subfeatures)||void 0===n?void 0:n.some((function(e){return"CDS"===e.type})),B=null===(t=b.subfeatures)||void 0===t?void 0:t.some((function(e){return"exon"===e.type})),q=(0,s.useRef)(null),_=(0,Z.useLocalStorage)("intronBp",10),D=(0,o.Z)(_,2),L=D[0],G=D[1],M=(0,Z.useLocalStorage)("upDownBp",500),T=(0,o.Z)(M,2),F=T[0],z=T[1],E=(0,s.useState)(!1),H=(0,o.Z)(E,2),I=H[0],A=H[1],R=(0,s.useState)(!1),U=(0,o.Z)(R,2),O=U[0],P=U[1],J=(0,s.useState)(!1),K=(0,o.Z)(J,2),Q=K[0],V=K[1],W=function(e,n,t,r){var a=(0,s.useState)(),c=(0,o.Z)(a,2),i=c[0],u=c[1],l=(0,s.useState)(),p=(0,o.Z)(l,2),d=p[0],f=p[1];return(0,s.useEffect)((function(){var s,a=!1;if(!e)return function(){};var c=(0,Z.getSession)(e),i=c.assemblyManager,l=c.rpcManager,p=(null===(s=e.view)||void 0===s?void 0:s.assemblyNames)||[],d=(0,o.Z)(p,1)[0];function m(e,n,t){return x.apply(this,arguments)}function x(){return(x=(0,g.Z)((0,v.Z)().mark((function e(n,t,r){var s,a,c,u,p,f;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.waitForAssembly(d);case 2:if(s=e.sent){e.next=5;break}throw new Error("assembly not found");case 5:return a="getSequence",e.next=8,l.call(a,"CoreGetFeatures",{adapterConfig:(0,j.getConf)(s,["sequence","adapter"]),sessionId:a,regions:[{start:n,end:t,refName:s.getCanonicalRefName(r),assemblyName:d}]});case 8:return c=e.sent,u=c,p=(0,o.Z)(u,1),f=p[0],e.abrupt("return",(null===f||void 0===f?void 0:f.get("seq"))||"");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,g.Z)((0,v.Z)().mark((function e(){var o,s,c,i,l,p,d,x,Z;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,f(void 0),s=(o=n).start,c=o.end,i=o.refName,r||!(c-s>w)){e.next=7;break}u({error:"Genomic sequence larger than ".concat(w,'bp, use "force load" button to display')}),e.next=19;break;case 7:return l=s-t,p=c+t,e.next=11,m(s,c,i);case 11:return d=e.sent,e.next=14,m(Math.max(0,l),s,i);case 14:return x=e.sent,e.next=17,m(c,p,i);case 17:Z=e.sent,a||u({seq:d,upstream:x,downstream:Z});case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),console.error(e.t0),f(e.t0);case 25:case"end":return e.stop()}}),e,null,[[0,21]])})))(),function(){a=!0}}),[n,e,t,r]),{sequence:i,error:d}}(d,f,F,Q),X=W.sequence,Y=W.error,$=(0,s.useState)(k?"cds":B?"cdna":"genomic"),ee=(0,o.Z)($,2),ne=ee[0],te=ee[1],re=(0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)({},k?{cds:"CDS"}:{}),k?{protein:"Protein"}:{}),B?{cdna:"cDNA"}:{}),B?{gene:"Genomic w/ full introns"}:{}),B?{gene_updownstream:"Genomic w/ full introns +/- ".concat(F,"bp up+down stream")}:{}),B?{gene_collapsed_intron:"Genomic w/ ".concat(L,"bp intron")}:{}),B?{gene_updownstream_collapsed_intron:"Genomic w/ ".concat(L,"bp intron +/- ").concat(F,"bp up+down stream ")}:{}),B?{}:{genomic:"Genomic"}),B?{}:{genomic_sequence_updownstream:"Genomic +/- ".concat(F,"bp up+down stream")});return(0,C.jsxs)("div",{className:m.container2,children:[(0,C.jsx)(a.Z,{className:m.formControl,children:(0,C.jsx)(c.Z,{value:ne,onChange:function(e){return te(e.target.value)},children:Object.entries(re).map((function(e){var n=(0,o.Z)(e,2),t=n[0],r=n[1];return(0,C.jsx)(i.Z,{value:t,children:r},t)}))})}),(0,C.jsx)(a.Z,{className:m.formControl,children:(0,C.jsx)(u.Z,{className:m.button,variant:"contained",onClick:function(){var e=q.current;e&&(x()(e.textContent||"",{format:"text/plain"}),A(!0),setTimeout((function(){return A(!1)}),1e3))},children:I?"Copied to clipboard!":"Copy plaintext"})}),(0,C.jsx)(a.Z,{className:m.formControl,children:(0,C.jsx)(l.Z,{title:"The 'Copy HTML' function retains the colors from the sequence panel but cannot be pasted into some programs like notepad that only expect plain text",children:(0,C.jsx)(u.Z,{className:m.button,variant:"contained",onClick:function(){var e=q.current;e&&(x()(e.innerHTML,{format:"text/html"}),P(!0),setTimeout((function(){return P(!1)}),1e3))},children:O?"Copied to clipboard!":"Copy HTML"})})}),(0,C.jsx)(N,{upDownBp:F,intronBp:L,setIntronBp:G,setUpDownBp:z}),(0,C.jsx)("br",{}),"gene"===b.type?(0,C.jsx)(p.Z,{children:"Note: inspect subfeature sequences for protein/CDS computations"}):null,Y?(0,C.jsx)(p.Z,{color:"error",children:"".concat(Y)}):X?X?"error"in X?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(p.Z,{color:"error",children:X.error}),(0,C.jsx)(u.Z,{variant:"contained",color:"inherit",onClick:function(){return V(!0)},children:"Force load"})]}):(0,C.jsx)(s.Suspense,{fallback:(0,C.jsx)(h.LoadingEllipses,{}),children:(0,C.jsx)(y,{ref:q,feature:b,mode:ne,sequence:X,intronBp:L})}):(0,C.jsx)(p.Z,{children:"No sequence found"}):(0,C.jsx)(h.LoadingEllipses,{})]})}function N(e){var n=e.intronBp,t=e.upDownBp,r=e.setIntronBp,c=e.setUpDownBp,i=S().classes,u=(0,s.useState)(!1),l=(0,o.Z)(u,2),p=l[0],f=l[1];return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(a.Z,{className:i.formControl,children:(0,C.jsx)(d.Z,{onClick:function(){return f(!0)},children:(0,C.jsx)(b.Z,{})})}),p?(0,C.jsx)(s.Suspense,{fallback:(0,C.jsx)("div",{}),children:(0,C.jsx)(k,{handleClose:function(e){if(e){var n=e.upDownBp,t=e.intronBp;r(t),c(n)}f(!1)},upDownBp:t,intronBp:n})}):null]})}},25471:function(e,n,t){var r=t(71600);n.Z=void 0;var o=r(t(7152)),s=t(29938),a=(0,o.default)((0,s.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}),"Settings");n.Z=a}}]);
//# sourceMappingURL=6846.def82205.chunk.js.map