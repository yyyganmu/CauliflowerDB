"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[109],{10109:function(e,n,t){t.r(n),t.d(n,{default:function(){return be}});var o=t(96234),r=t(96902),s=t(90659),i=t(4782),a=t(75717),l=t(91188),c=t(45298),u=t.n(c),d=t(13655),h=t(2868),m=t(99782),f=t(80367),x=t(12221),v=t(80691),p=t(54417),b=t(6880),j=t(44536),y=t(95802),g=t(88315),Z=t.n(g),w=t(35388),k=t(29938);function C(e){var n=e.radioOption,t=e.assembly1,o=e.assembly2,r=e.fileLocation,s=e.bed1Location,i=e.bed2Location;if(".paf"===n)return{type:"PAFAdapter",pafLocation:r,queryAssembly:t,targetAssembly:o};if(".out"===n)return{type:"MashMapAdapter",outLocation:r,queryAssembly:t,targetAssembly:o};if(".delta"===n)return{type:"DeltaAdapter",deltaLocation:r,queryAssembly:t,targetAssembly:o};if(".chain"===n)return{type:"ChainAdapter",chainLocation:r,queryAssembly:t,targetAssembly:o};if(".anchors"===n)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:r,bed1Location:s,bed2Location:i,assemblyNames:[t,o]};if(".anchors.simple"===n)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:r,bed1Location:s,bed2Location:i,assemblyNames:[t,o]};throw new Error("Unknown type")}var S=(0,i.observer)((function(e){e.sessionTrackData;var n=e.assembly1,t=e.assembly2,i=e.setSessionTrackData,a=(0,r.useState)(),l=(0,o.Z)(a,2),c=l[0],u=l[1],d=(0,r.useState)(),h=(0,o.Z)(d,2),v=h[0],j=h[1],y=(0,r.useState)(),g=(0,o.Z)(y,2),S=g[0],L=g[1],M=(0,r.useState)(""),P=(0,o.Z)(M,2),N=P[0],A=P[1],T=(0,r.useState)(),z=(0,o.Z)(T,2),D=z[0],I=z[1],B=function(e){return e?e.uri||e.localPath||e.name:void 0}(S),E=N||(B?Z().extname(function(e){return e.endsWith(".gz")?e.slice(0,-3):e}(B)):"");return(0,r.useEffect)((function(){try{if(S){var e=B?Z().basename(B):"MyTrack",o="".concat(e,"-").concat(Date.now());I(void 0),i({trackId:o,name:e,assemblyNames:[t,n],type:"SyntenyTrack",adapter:C({radioOption:E,assembly1:n,assembly2:t,fileLocation:S,bed1Location:v,bed2Location:c})})}}catch(r){console.error(r),I(r)}}),[B,n,t,v,c,S,E,i]),(0,k.jsxs)(b.Z,{style:{padding:12},children:[D?(0,k.jsx)(s.ErrorMessage,{error:D}):null,(0,k.jsx)(w.Z,{style:{textAlign:"center"},children:"Add a .paf, .out (MashMap), .delta (Mummer), .chain, .anchors or .anchors.simple (MCScan) file to view in the dotplot. These file types can also be gzipped. The first assembly should be the query sequence (e.g. left column of the PAF) and the second assembly should be the target sequence (e.g. right column of the PAF)"}),(0,k.jsx)(m.Z,{value:E,onChange:function(e){return A(e.target.value)},children:(0,k.jsxs)(p.ZP,{container:!0,justifyContent:"center",children:[(0,k.jsx)(p.ZP,{item:!0,children:(0,k.jsx)(f.Z,{value:".paf",control:(0,k.jsx)(x.Z,{}),label:".paf"})}),(0,k.jsx)(p.ZP,{item:!0,children:(0,k.jsx)(f.Z,{value:".out",control:(0,k.jsx)(x.Z,{}),label:".out"})}),(0,k.jsx)(p.ZP,{item:!0,children:(0,k.jsx)(f.Z,{value:".delta",control:(0,k.jsx)(x.Z,{}),label:".delta"})}),(0,k.jsx)(p.ZP,{item:!0,children:(0,k.jsx)(f.Z,{value:".chain",control:(0,k.jsx)(x.Z,{}),label:".chain"})}),(0,k.jsx)(p.ZP,{item:!0,children:(0,k.jsx)(f.Z,{value:".anchors",control:(0,k.jsx)(x.Z,{}),label:".anchors"})}),(0,k.jsx)(p.ZP,{item:!0,children:(0,k.jsx)(f.Z,{value:".anchors.simple",control:(0,k.jsx)(x.Z,{}),label:".anchors.simple"})})]})}),(0,k.jsx)(p.ZP,{container:!0,justifyContent:"center",children:(0,k.jsx)(p.ZP,{item:!0,children:".anchors"===N||".anchors.simple"===N?(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{style:{margin:20},children:["Open the ",N," and .bed files for both genome assemblies from the MCScan (Python version) pipeline"," ",(0,k.jsx)("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)",children:"(more info)"})]}),(0,k.jsxs)("div",{style:{display:"flex"},children:[(0,k.jsx)("div",{children:(0,k.jsx)(s.FileSelector,{name:".anchors file",description:"",location:S,setLocation:function(e){return L(e)}})}),(0,k.jsx)("div",{children:(0,k.jsx)(s.FileSelector,{name:"genome 1 .bed (left column of anchors file)",description:"",location:v,setLocation:function(e){return j(e)}})}),(0,k.jsx)("div",{children:(0,k.jsx)(s.FileSelector,{name:"genome 2 .bed (right column of anchors file)",description:"",location:c,setLocation:function(e){return u(e)}})})]})]}):(0,k.jsx)(s.FileSelector,{name:N?N+" location":"",description:"",location:S,setLocation:function(e){return L(e)}})})})]})})),L=t(68079),M=t(33266),P=t(15996),N=t(16151),A=t(99836),T=t(23642);var z=(0,i.observer)((function(e){var n,t=e.model,i=e.assembly1,a=e.assembly2,l=e.setShowTrackId,c=(0,y.getSession)(t),u=c.tracks,d=c.sessionTracks,h=[].concat((0,L.Z)(u),(0,L.Z)(d)).filter((function(e){return function(e,n,t){var o=(0,A.readConfObject)(e,"assemblyNames");return o.includes(n)&&o.includes(t)&&e.type.includes("Synteny")}(e,a,i)})),m=(null===(n=h[0])||void 0===n?void 0:n.trackId)||"",f=(0,r.useState)(m),x=(0,o.Z)(f,2),v=x[0],p=x[1];return(0,r.useEffect)((function(){p(m)}),[m]),(0,r.useEffect)((function(){l(v)}),[v,l]),(0,k.jsxs)(b.Z,{style:{padding:12},children:[(0,k.jsx)(w.Z,{paragraph:!0,children:'Select a track from the select box below, the track will be shown when you hit "Launch".'}),(0,k.jsxs)(w.Z,{paragraph:!0,children:["Note: there is a track selector ",(0,k.jsx)("i",{children:"inside"})," the DotplotView, which can turn on one or more SyntenyTracks (more than one can be displayed at once). Look for the track selector icon ",(0,k.jsx)(T.GD,{})]}),h.length?(0,k.jsx)(M.Z,{value:v,onChange:function(e){return p(e.target.value)},children:h.map((function(e){return(0,k.jsx)(P.Z,{value:e.trackId,children:(0,N.getTrackName)(e,c)},e.trackId)}))}):(0,k.jsx)(s.ErrorMessage,{error:"No synteny tracks found for ".concat(i,",").concat(a)})]})})),D=(0,l.ZL)()((function(e){return{importFormContainer:{padding:e.spacing(4),margin:"0 auto"},assemblySelector:{width:"75%",margin:"0 auto"}}}));function I(e){var n=e.setSessionTrackData,t=e.setShowTrackId,s=e.sessionTrackData,i=e.assembly1,a=e.assembly2,l=e.model,c=(0,r.useState)("none"),u=(0,o.Z)(c,2),v=u[0],p=u[1];return(0,r.useEffect)((function(){"none"===v&&(n(void 0),t(void 0))}),[v,n,t]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(d.Z,{children:[(0,k.jsx)(h.Z,{id:"group-label",children:"(Optional) Select or add a synteny track"}),(0,k.jsxs)(m.Z,{row:!0,value:v,onChange:function(e){return p(e.target.value)},"aria-labelledby":"group-label",children:[(0,k.jsx)(f.Z,{value:"none",control:(0,k.jsx)(x.Z,{}),label:"None"}),(0,k.jsx)(f.Z,{value:"tracklist",control:(0,k.jsx)(x.Z,{}),label:"Existing track"}),(0,k.jsx)(f.Z,{value:"custom",control:(0,k.jsx)(x.Z,{}),label:"New track"})]})]}),"custom"===v?(0,k.jsx)(S,{setSessionTrackData:n,sessionTrackData:s,assembly2:a,assembly1:i}):null,"tracklist"===v?(0,k.jsx)(z,{model:l,assembly1:i,assembly2:a,setShowTrackId:t}):null]})}var B=(0,i.observer)((function(e){var n=e.model,t=D().classes,i=(0,y.getSession)(n),l=i.assemblyNames,c=(0,r.useState)(l[0]||""),u=(0,o.Z)(c,2),h=u[0],m=u[1],f=(0,r.useState)(l[0]||""),x=(0,o.Z)(f,2),g=x[0],Z=x[1],w=(0,r.useState)(),C=(0,o.Z)(w,2),S=C[0],L=C[1],M=(0,r.useState)(),P=(0,o.Z)(M,2),N=P[0],A=P[1],T=(0,r.useState)(),z=(0,o.Z)(T,2),B=z[0],E=z[1];var R=S||n.error;return(0,k.jsxs)(v.Z,{className:t.importFormContainer,children:[R?(0,k.jsx)(s.ErrorMessage,{error:R}):null,(0,k.jsx)(p.ZP,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",className:t.assemblySelector,children:(0,k.jsxs)(p.ZP,{item:!0,children:[(0,k.jsxs)(b.Z,{style:{padding:12},children:[(0,k.jsx)("p",{style:{textAlign:"center"},children:"Select assemblies for dotplot view"}),(0,k.jsxs)(p.ZP,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:[(0,k.jsx)(p.ZP,{item:!0,children:(0,k.jsx)(s.AssemblySelector,{selected:g,onChange:function(e){return Z(e)},session:i})}),(0,k.jsx)(p.ZP,{item:!0,children:(0,k.jsx)(s.AssemblySelector,{selected:h,onChange:function(e){return m(e)},session:i})}),(0,k.jsx)(p.ZP,{item:!0,children:(0,k.jsx)(d.Z,{children:(0,k.jsx)(j.Z,{onClick:function(){try{if(!(0,y.isSessionWithAddTracks)(i))return;L(void 0),n.setError(void 0),(0,a.transaction)((function(){N?(i.addTrackConf(N),n.toggleTrack(N.trackId)):B&&n.showTrack(B),n.setViews([{bpPerPx:.1,offsetPx:0},{bpPerPx:.1,offsetPx:0}]),n.setAssemblyNames(h,g)}))}catch(e){console.error(e),L(e)}},variant:"contained",color:"primary",children:"Launch"})})})]})]}),(0,k.jsx)(I,{setShowTrackId:E,assembly2:h,assembly1:g,setSessionTrackData:A,sessionTrackData:N,model:n})]})})]})})),E=t(25322),R=t(30156),F=t(96050),V=t(38238),H=t(33028),q=t(66026);function O(e){return(0,k.jsx)(q.Z,(0,H.Z)((0,H.Z)({},e),{},{children:(0,k.jsx)("path",{fill:"currentColor",d:"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z"})}))}function W(e){return(0,k.jsx)(q.Z,(0,H.Z)((0,H.Z)({},e),{},{children:(0,k.jsx)("path",{fill:"currentColor",d:"M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"})}))}var _=t(49408),X=(0,r.lazy)((function(){return Promise.all([t.e(534),t.e(615),t.e(8388)]).then(t.bind(t,85898))})),Y=(0,i.observer)((function(e){var n=e.model.tracks.filter((function(e){var n;return null===(n=e.displays[0].warnings)||void 0===n?void 0:n.length})),t=(0,r.useState)(!1),s=(0,o.Z)(t,2),i=s[0],a=s[1];return n.length?(0,k.jsxs)(_.Z,{severity:"warning",children:["Warnings during render"," ",(0,k.jsx)(j.Z,{onClick:function(){return a(!0)},children:"More info"}),i?(0,k.jsx)(X,{trackWarnings:n,handleClose:function(){return a(!1)}}):null]}):null})),G=t(74859),U=t(59489),J=t(5836),K=t(90001),Q=(0,l.ZL)()({dpad:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",margin:0,position:"absolute",right:50,zIndex:1e3,top:50},icon:{padding:0,margin:0}}),$=(0,i.observer)((function(e){var n=e.model,t=Q().classes;return(0,k.jsxs)(b.Z,{className:t.dpad,elevation:6,children:[(0,k.jsx)("div",{}),(0,k.jsx)(E.Z,{className:t.icon,onClick:function(){return n.vview.scroll(100)},children:(0,k.jsx)(U.Z,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(E.Z,{className:t.icon,onClick:function(){return n.hview.scroll(-100)},children:(0,k.jsx)(J.Z,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(E.Z,{className:t.icon,onClick:function(){return n.hview.scroll(100)},children:(0,k.jsx)(K.Z,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(E.Z,{className:t.icon,onClick:function(){return n.vview.scroll(-100)},children:(0,k.jsx)(G.Z,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(E.Z,{className:t.icon,onClick:function(){n.hview.zoomIn(),n.vview.zoomIn()},children:(0,k.jsx)(F.Z,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(E.Z,{className:t.icon,onClick:function(){n.hview.zoomOut(),n.vview.zoomOut()},children:(0,k.jsx)(R.Z,{})})]})})),ee=(0,l.ZL)()({iconButton:{margin:5},bp:{display:"flex",alignItems:"center",marginLeft:10},spacer:{flexGrow:1},headerBar:{display:"flex",position:"relative"}}),ne=(0,i.observer)((function(e){var n=e.model,t=ee().classes,i=(0,r.useState)(),a=(0,o.Z)(i,2),l=a[0],c=a[1];return(0,k.jsxs)("div",{children:[(0,k.jsx)(E.Z,{onClick:n.zoomOutButton,className:t.iconButton,children:(0,k.jsx)(R.Z,{})}),(0,k.jsx)(E.Z,{onClick:n.zoomInButton,className:t.iconButton,children:(0,k.jsx)(F.Z,{})}),(0,k.jsx)(E.Z,{onClick:function(){return n.activateTrackSelector()},className:t.iconButton,title:"Open track selector","data-testid":"circular_track_select",children:(0,k.jsx)(T.GD,{})}),(0,k.jsx)(E.Z,{onClick:function(e){return c(e.currentTarget)},className:t.iconButton,children:(0,k.jsx)(V.Z,{})}),l?(0,k.jsx)(s.Menu,{anchorEl:l,open:!0,onMenuItemClick:function(e,n){n(),c(void 0)},menuItems:[{onClick:function(){return n.squareView()},label:"Square view - same base pairs per pixel"},{onClick:function(){return n.squareViewProportional()},label:"Rectanglularize view - same total bp"},{onClick:function(){return n.showAllRegions()},label:"Show all regions"},{onClick:function(){return n.setDrawCigar(!n.drawCigar)},type:"checkbox",label:"Draw CIGAR",checked:n.drawCigar},{onClick:function(){return n.setShowPanButtons(!n.showPanButtons)},label:"Show pan buttons",type:"checkbox",checked:n.showPanButtons},{label:"Click and drag mode",subMenu:[{onClick:function(){return n.setCursorMode("move")},label:"Pan by default, select region when ctrl key is held",icon:O,type:"radio",checked:"move"===n.cursorMode},{onClick:function(){return n.setCursorMode("crosshair")},label:"Select region by default, pan when ctrl key is held",icon:W,type:"radio",checked:"crosshair"===n.cursorMode}]},{label:"Wheel scroll mode",subMenu:[{onClick:function(){return n.setWheelMode("pan")},label:"Pans view",type:"radio",checked:"pan"===n.wheelMode},{onClick:function(){return n.setWheelMode("zoom")},label:"Zooms view",type:"radio",checked:"zoom"===n.wheelMode},{onClick:function(){return n.setWheelMode("none")},label:"Disable",type:"radio",checked:"none"===n.wheelMode}]}],onClose:function(){return c(void 0)}}):null]})})),te=(0,i.observer)((function(e){var n=e.model,t=e.selection,o=ee().classes,r=n.hview,s=n.vview,i=n.showPanButtons;return(0,k.jsxs)("div",{className:o.headerBar,children:[(0,k.jsx)(ne,{model:n}),(0,k.jsxs)(w.Z,{className:o.bp,variant:"body2",color:"textSecondary",children:["x: ",r.assemblyNames.join(",")," ",(0,y.getBpDisplayStr)(r.currBp),(0,k.jsx)("br",{}),"y: ",s.assemblyNames.join(",")," ",(0,y.getBpDisplayStr)(s.currBp)]}),t?(0,k.jsxs)(w.Z,{className:o.bp,variant:"body2",color:"textSecondary",children:["width:".concat((0,y.getBpDisplayStr)(r.bpPerPx*t.width))," ",(0,k.jsx)("br",{}),"height:".concat((0,y.getBpDisplayStr)(s.bpPerPx*t.height))]}):null,(0,k.jsx)("div",{className:o.spacer}),(0,k.jsx)(Y,{model:n}),i?(0,k.jsx)($,{model:n}):null]})})),oe=t(78866),re=t(56131),se=t(44529),ie=t(16644),ae=t(60131),le=t(61291);var ce=(0,l.ZL)()((function(e){return{tooltip:{position:"absolute",pointerEvents:"none",backgroundColor:(0,ie.Fq)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(12),lineHeight:"".concat((n=1.4,Math.round(1e5*n)/1e5),"em"),maxWidth:300,wordWrap:"break-word"}};var n})),ue={left:0,top:0,width:0,height:0},de=(0,i.observer)((function(e){var n,t=e.model,s=e.mouserect,i=e.mouserectClient,a=e.xdistance,l=e.ydistance,c=ce().classes,u=t.hview,d=t.vview,h=t.viewHeight,m=(0,r.useState)(null),f=(0,o.Z)(m,2),x=f[0],v=f[1],p=(null===(n=(0,r.useRef)(null).current)||void 0===n?void 0:n.getBoundingClientRect())||ue,b=p.height+12,j=(0,r.useMemo)((function(){return{getBoundingClientRect:function(){var e=6+((null===i||void 0===i?void 0:i[0])||0)-(a<0?b:0),n=6+((null===i||void 0===i?void 0:i[1])||0)-(l<0?b:0);return{top:n,left:e,bottom:n,right:e,width:0,height:0,x:e,y:n,toJSON:function(){}}}}}),[i,a,l,b]),y=(0,le.D)(j,x,{placement:a<0?"left":"right"}),g=y.styles,Z=y.attributes;return(0,k.jsx)(k.Fragment,{children:s?(0,k.jsx)(ae.Z,{children:(0,k.jsxs)("div",(0,H.Z)((0,H.Z)({ref:v,className:c.tooltip,style:(0,H.Z)((0,H.Z)({},g.popper),{},{zIndex:1e5})},Z.popper),{},{children:["x - ".concat((0,se.c4)(s[0],u)),(0,k.jsx)("br",{}),"y - ".concat((0,se.c4)(h-s[1],d)),(0,k.jsx)("br",{})]}))}):null})})),he=(0,i.observer)((function(e){var n=e.model,t=e.mousedown,s=e.mousedownClient,i=e.xdistance,a=e.ydistance,l=ce().classes,c=n.hview,u=n.vview,d=n.viewHeight,h=(0,r.useState)(null),m=(0,o.Z)(h,2),f=m[0],x=m[1],v=(0,r.useMemo)((function(){return{getBoundingClientRect:function(){var e=((null===s||void 0===s?void 0:s[0])||0)-0,n=((null===s||void 0===s?void 0:s[1])||0)-0;return{top:n,left:e,bottom:n,right:e,width:0,height:0,x:e,y:n,toJSON:function(){}}}}}),[s,i,a]),p=(0,le.D)(v,f,{placement:i<0?"right":"left"}),b=p.styles,j=p.attributes;return(0,k.jsx)(k.Fragment,{children:t&&Math.abs(i)>3&&Math.abs(a)>3?(0,k.jsx)(ae.Z,{children:(0,k.jsxs)("div",(0,H.Z)((0,H.Z)({ref:x,className:l.tooltip,style:(0,H.Z)((0,H.Z)({},b.popper),{},{zIndex:1e5})},j.popper),{},{children:["x - ".concat((0,se.c4)(t[0],c)),(0,k.jsx)("br",{}),"y - ".concat((0,se.c4)(d-t[1],u)),(0,k.jsx)("br",{})]}))}):null})})),me={left:0,top:0,width:0,height:0},fe=(0,l.ZL)()((function(e){return{spacer:{gridColumn:"1/2",gridRow:"2/2"},root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},container:{display:"grid",padding:5,position:"relative"},overlay:{pointerEvents:"none",overflow:"hidden",display:"flex",width:"100%",gridRow:"1/2",gridColumn:"2/2",zIndex:100,"& path":{cursor:"crosshair",fill:"none"}},content:{position:"relative",gridColumn:"2/2",gridRow:"1/2"},resizeHandle:{height:4,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}}}));function xe(e,n){return e&&[e[0]-n.left,e[1]-n.top]}var ve=(0,i.observer)((function(e){var n=e.model,t=fe().classes;return(0,k.jsx)("div",{className:t.overlay,children:n.tracks.map((function(e){var n=(0,o.Z)(e.displays,1)[0],t=n.RenderingComponent;return t?(0,k.jsx)(t,{model:n},e.configuration.trackId):null}))})})),pe=(0,i.observer)((function(e){var n,t,i=e.model,l=fe().classes,c=(0,r.useState)(),d=(0,o.Z)(c,2),h=d[0],m=d[1],f=(0,r.useState)(),x=(0,o.Z)(f,2),v=x[0],p=x[1],b=(0,r.useState)(!1),j=(0,o.Z)(b,2),y=j[0],g=j[1],Z=(0,r.useState)(),w=(0,o.Z)(Z,2),C=w[0],S=w[1],L=(0,r.useRef)(null),M=(0,r.useRef)(null),P=(0,r.useRef)(0),N=(0,r.useRef)(0),A=(0,r.useRef)(!1),T=(0,r.useState)(!1),z=(0,o.Z)(T,2),D=z[0],I=z[1],B=(null===(n=L.current)||void 0===n?void 0:n.getBoundingClientRect())||me,E=(null===(t=L.current)||void 0===t?void 0:t.getBoundingClientRect())||me,R=xe(v,B),F=xe(h,B),V=xe(C,B),H=C||h,q=V||F,O=R&&q?q[0]-R[0]:0,W=R&&q?q[1]-R[1]:0,_=i.hview,X=i.vview,Y=i.wheelMode,G=i.cursorMode,U="move"===G&&!D||"crosshair"===G&&D,J="move"===G&&D||"crosshair"===G&&!D;return(0,r.useEffect)((function(){function e(e){var n=u()(e);e.preventDefault(),P.current+=n.pixelX,N.current-=n.pixelY,A.current||(A.current=!0,window.requestAnimationFrame((function(){(0,a.transaction)((function(){if("pan"===Y)_.scroll(P.current/3),X.scroll(N.current/10);else if("zoom"===Y&&Math.abs(N.current)>2*Math.abs(P.current)&&F){var e=N.current<0?1.1:.9;_.zoomTo(_.bpPerPx*e,F[0]),X.zoomTo(X.bpPerPx*e,E.height-F[1])}})),A.current=!1,P.current=0,N.current=0})))}if(L.current){var n=L.current;return n.addEventListener("wheel",e),function(){return n.removeEventListener("wheel",e)}}return function(){}}),[_,X,Y,F,E.height]),(0,r.useEffect)((function(){function e(e){m([e.clientX,e.clientY]),h&&v&&U&&!C&&(_.scroll(-e.clientX+h[0]),X.scroll(e.clientY-h[1]))}return window.addEventListener("mousemove",e),function(){return window.removeEventListener("mousemove",e)}}),[U,h,v,G,D,C,_,X]),(0,r.useEffect)((function(){function e(e){Math.abs(O)>3&&Math.abs(W)>3&&J?S([e.clientX,e.clientY]):p(void 0)}return R&&!V?(window.addEventListener("mouseup",e,!0),function(){return window.removeEventListener("mouseup",e,!0)}):function(){}}),[J,R,F,V,O,W,D,G]),(0,k.jsxs)("div",{children:[(0,k.jsx)(te,{model:i,selection:J&&R&&q?{width:Math.abs(O),height:Math.abs(W)}:void 0}),(0,k.jsxs)("div",{ref:M,className:l.root,onMouseLeave:function(){return g(!1)},onMouseEnter:function(){return g(!0)},children:[(0,k.jsxs)("div",{className:l.container,children:[(0,k.jsx)(re.UL,{model:i}),(0,k.jsx)(re.u_,{model:i}),(0,k.jsxs)("div",{ref:L,className:l.content,children:[y&&J?(0,k.jsx)(de,{model:i,mouserect:q,mouserectClient:H,xdistance:O,ydistance:W}):null,J?(0,k.jsx)(he,{model:i,mousedown:R,mousedownClient:v,xdistance:O,ydistance:W}):null,(0,k.jsx)("div",{style:{cursor:D?"pointer":G},onMouseDown:function(e){if(0===e.button){var n=e.clientX,t=e.clientY;p([n,t]),m([n,t]),I(e.ctrlKey)}},children:(0,k.jsx)(oe.Z,{model:i,children:J&&R&&q?(0,k.jsx)("rect",{fill:"rgba(255,0,0,0.3)",x:Math.min(q[0],R[0]),y:Math.min(q[1],R[1]),width:Math.abs(O),height:Math.abs(W)}):null})}),(0,k.jsx)("div",{className:l.spacer})]}),(0,k.jsx)(ve,{model:i}),(0,k.jsx)(s.Menu,{open:Boolean(V),onMenuItemClick:function(e,n){n(),S(void 0),p(void 0)},onClose:function(){S(void 0),p(void 0)},anchorReference:"anchorPosition",anchorPosition:C?{top:C[1]+50,left:C[0]+50}:void 0,style:{zIndex:1e4},menuItems:[{label:"Zoom in",onClick:function(){R&&V&&i.zoomIn(R,V)}},{label:"Open linear synteny view",onClick:function(){R&&V&&i.onDotplotView(R,V)}}]})]}),(0,k.jsx)(s.ResizeHandle,{onDrag:function(e){return i.setHeight(i.height+e)},className:l.resizeHandle})]})]})})),be=(0,i.observer)((function(e){var n=e.model,t=n.initialized,o=n.loading,r=n.error;return!t&&!o||r?(0,k.jsx)(B,{model:n}):o?(0,k.jsx)(s.LoadingEllipses,{variant:"h6"}):(0,k.jsx)(pe,{model:n})}))},59489:function(e,n,t){var o=t(71600);n.Z=void 0;var r=o(t(7152)),s=t(29938),i=(0,r.default)((0,s.jsx)("path",{d:"m7 14 5-5 5 5z"}),"ArrowDropUp");n.Z=i},5836:function(e,n,t){var o=t(71600);n.Z=void 0;var r=o(t(7152)),s=t(29938),i=(0,r.default)((0,s.jsx)("path",{d:"m14 7-5 5 5 5V7z"}),"ArrowLeft");n.Z=i}}]);
//# sourceMappingURL=109.5261e339.chunk.js.map